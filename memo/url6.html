<!doctype HTML.'.;: + :;../inc/config.php'>
<html>
    <head>
        <title>View Users</title>
		<?php include '../inc/head_tag.php'; ?>
    </head>
    <body>
    	<!-- Navbar -->
    	<?php include '../inc/navbar.php'; ?>
        
        <!-- Main Content -->
        <div id="main">
            <?php
                // Include config file
                
                require '../inc/config.php';
            
                // Get user data from
                $result = mysqli_query($conn, "SELECT * FROM users");
            
                echo '<h1 class="text-center my-5">All Users</
                    h1>';
            
                if (mysqli_num_rows($result) > 0) {
                    // Output a header row
                    echo "<table class='table table-striped w-75 mx-auto'><thead>";
                    echo "<tr>";
                    echo "<th scope='col'>ID</th>";
                    echo "<th scope='col'>Username</th>";
                    echo "<th colspan='2 text'>Password</th>";
                    echo "</tr></thead>";
                    
                    // Output each row of data
                    while ($row = mysqli_fetch_assoc($result)) {
                        echo "<tbody><tr>";
                        echo "<td>" . $row['id'] . "</td>";
                        echo "<td>" . $row['username'] . "</td>";
                        echo "<td>Show Password</td>";
                        echo "<td><a href='view_user_password.php?id=". $row['id']. "' class='btn btn-primary'>View Password</a></td>";
                        echo "<td><a href='view_user_password.php?id=". $row['id']. "' class='btn btn-primary'>View</a></td>";
                        echo "<td><a href='viewUserPass.php?id=". $row['id']. "' class='btn btn-primary'>Click Here
                        echo "<td><a href='view_user_password.php?id=". $row['id']. "' class='btn btn-primary'>Click Here!</a></td
                        echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>Click Here!</a/></td></tr></table>
                        echo "<td><a href='page_details.php?id=" . $row['id'] . "' class='btn btn-primary'>Details</a></td>";
                        echo "<td><a href='Detail Form?id=".$row['id']."' class='btn btn-primary'>Details</a></td>";
                        echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>Go!</a></
                        echo "<td><a href='view_user_password.php?id=". $row['id']. "' class='btn btn-primary'>Click Here!</a></td
                        echo "<td><a href='view_user_password.php?id=". $row['id']. "' class='btn btn-primary'>Click Here!</a></td
                        echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>Go to password view page
                        echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>Click Here!</a
                        echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>Go to password view page
                            echo "<td><a href='view_user_password.php?id=" . $row['id'] . "' class='btn btn-primary'>
                        echo "<td><a href=' password.php?id=". $row['id']. "' class='btn btn-primary'>Click Here
                        echo "<td><a href='show_password.php?id=" . $row['id'] . "' class='btn btn-primary'>View</a></td>";
                        echo "<td><a href='editUser.php?id=". $row['id']. "' class='btn btn-primary'>
                            Edit User
                            </a></td>";
                            echo "</tr>\n";
                    }
                    echo "</tbody></table>";
                } else {
                    echo "No results found.";
                }
            
                mysqli_close($conn);
?>
<div class="d-flex justify-content-around align-items-end flex- justify-content-center vh-100">
    <button type="button" onclick=" location.href='addUser.html'" class="btn btn-success">Add User</button>
</div>
<?php include 'footer.php'; ?>
</body>
</html>
<box.stuff.move'X_File.<h'(eading'))tm."({% load flatpages %}www.example.com>
{% get_flatpage 'contact' as contact %}{{ contact }} %}
script src="https://code.jquery.com
/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nC
A67ubOtRi2+asRMHldXANFsizcchPSEZiNwytn+Pj+Pw6TD9UgWk7on3RYdgmVGOpnW9oSsr
QRm3rKswuBvh1OW2OnnE5dgruntcDov+I/jeyfl3+RK\x9d crossorigin=anonymou
s></script>
<script src="https://stackpath. Jenkins, WY 82611</strong>: (437) 555-0149</li>
<li><strong>Email:</strong> john@example.com</li>
</ul>
</div>
</div> <!-- /container --></section> <!-- End Contact Section --></div> <!-- /col --></div> <!-- /row --></div> <!-- /container
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
@media only screen and (min-width: 992px){#mainNav{display:flex}.navbar-toggler{display:none}#sidebarContent{position:static;height:auto;visibility
</div>
</div>
<decimal.;'('></)'r._id.'?q=%22'+encodeURIComponent(search)+'%22')
        .then(response => response.json
        ())
        .then((data) => {
            console.log(data);
            if (!data.length) {
                document.getElementById("results").innerHTML = "<p>No Results Found.</p>";
            } else {
                let output = '';
                data.forEach((user) => {
                    output += `
                    <div class="card mb-3">
                        <div class="row no-gutters">
                            <div class="col-md-4">
                                <img src="${user.image}" alt="${user.name}">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <h5 class="card-title">${user.name}</h5>
                                    <p class="card-text"><strong>Phone:</strong> ${
                                        user.phone
                                    }<br />
                                    <strong>Email:</strong> ${
                                        user.email
                                    }<br /></p>
                                    <a href="#" class="btn btn-primary" onclick="window. confirm('Are you sure
                                    <a href="#" class="btn btn-primary" onclick="openModal(${
                                        '{&quot;name&quot;:' + '"' + user.name + '", &quot;phone&quot;:' + user.
                                        '{&quot;name&quot;:' + '"' + user.name + '",' +
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"'
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"}'
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"}'
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"'
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"}'
                                        '"phone&quot;:' + user.phone  + ', &quot;email&quot;:' + '"' + user.email + '"
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>View Details</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email    &quot;:' + '"' + user.
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"'
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"})'>View Details</a>
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"'
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"' + user.phone + '
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"'
                                        '"phone&quot;:' + user.phone + ', &quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"phone&quot;:' + user.phone + ',&quot;email&quot;:' + '"' + user.email + '"})'>More info &raqu
                                        '"id&quot;:' + user.id + ',&quot;email&quot;:' + '"' + user.email + '"})'>More Info</a>
                                        '"id&quot;:' + user.id + ',&quot;email&quot;:' + '"' + user.email + '"})'>More Details</a>
                                        '"image&quot;:' + '"' + user.image + '"})'>More Info</a>
                                </div>
                            </div>
                        </div>
                    </div>`);
                });
            },
            });
        }
        
        function openModal(data) {
            $('#userName').html(data.name);
            $("#profileImage").attr("src", data.image);
            
            var modal = document.getElementById('myModal');
            // Wire up our events
            modal.addEventListener('show.bs.modal', function (event) {
              // Nothing to do here
            })
            
            // Show the modal
            $(modal).modal({ show: true });
            });
        };
    
        function getUserData() {
            $.ajax({
                url: "/users/get_current_user",
                type: "GET", dataType: 'json', data: {},
                success: function(response){
                    if (!response["success"]){
                        alert("Error getting current user");
                    } else {
                        setCurrentUser(response['user']);
                    }
                    }
                    });
        }
        
        function searchUsers(){
            var queryString = $("#searchBar").val();
            console.log(queryString);
            $.ajax({
                url: '/users/search?q=' + encodeURIComponent(queryString),
                method: 'GET' , dataType: 'json', data:{} ,
                success:function(response, status, xhr) {
                    populateTableWithResults(response['results'], response['totalCount']) ;
                    }, error: function(xhr, status, err) {
                    console.error("Search Error", status, err.message);
                    }
            }).done(function(data) {
               /* Hide any previous results */
                $('#tableBody').empty();
                });
        }

        /**
         * Fill table with users from a list of User objects.
         * @param {Array} users - A list of User objects to be displayed in the table.
         * @param {Number} totalCount - The total number of Users that match the given filter criteria.
         */
        function populateTableWithResults(users, totalCount) {
            // Clear out old results and create new rows for each user.
            $('#resultCount').text('Showing ' + users.length + ' of ' + totalCount + ' Results');
            $('#tableBody').empty();
            
            users.forEach(function (user)
            {
                var row = $('<tr>') ;
                row.append($('<td>').html(user.username))
                    .append($('<td>').html(user.firstName))
                    .attr('id', user + ' ' + user.lastName) '</td>'  // Useful for getting element by id later on.
                    .attr('id', user._id).click(showProfile);
                $('#tableBody').append(row);
            })
        };
</script>

<!-- HTML -->
<div class="container">
    <h2 id="title" style="margin-top: 10px;">User Search</h2>
    
    <!-- Search bar -->
    <form onsubmit="event.preventDefault()">
        <input type="text" id="searchTerm" placeholder="Username..." />
        <button onclick="doSearch()" >
            Search
        </button>
    </form>
    
    <!-- Result count display -->
    <p id="resultCount"></p>
    
    <!-- Table displaying search results -->
    <table id="resultsTable" class="table table-striped">
        <thead>
            <th>Username</th>
            <th>First Name</th>
        </thead>
        <tbody id="tableBody">
        </tbody>
        </table>
</div>
                                    open(&quot;https://www.google.com/maps/?q=loc Bloomberg , New York&quot;,'+ encodeURI + user.phone + ', &quot;email + user.phone + ',&quot;email + user.phone + ',&quot;email + user.phone + ',&quot;email  + user.phone + ',&quot; + user.phone + ',&quot;email,&quot; + user.phone + ',&quot; + user.phone + ',&quot; + user.phone + ', + user.phone + ', &quot;email + user.phone + ', &quot;email + user.phone + ',&quot;email + user.phone + ',&quot;email + user.phone + ',&quot;email + user.phone + ',&quot;email
                                    10, New York&quot;)" role="button">Get Directions</a><br />
                                </div>
                            </div>
                        </div>
                    </div>
                    `;
                });
                document.getElementById("results").innerHTML = output;
            }
            })
        .catch((err) => {
            console.log(`Error: ${err}`);
            document.getElementById("results")
                .innerHTML = `<p>An error occurred while processing your request.</p>`;
        });
};
// Add the event listener to search button
document.querySelector("#searchBtn").addEventListener("click", displayResults);
function doSearch(){
    // Clear previous results and set result count to 0
    document.getElementById("tableBody").innerHTML = "";
    document.getElementById("resultCount").innerText = "Number of Results: ";
    // Call function to get user input and make API call
    let username = document.getElementById("usernameField").value;
    if (username != ""){username = "?username=" + encodeURIComponent(username)} ;
    else {username = ""}
    apiCall("/users/lookup/"+username);
    }
//Add enter key functionality to search field
document.getElementById("usernameField").addEventListener("keyup", function(event){
    if (event.key === "Enter"){doSearch()}
});
/* Function that makes an API call with a specified endpoint */
function apiCall(endpoint){
    fetch("https://api.github.com" + endpoint, {method:"GET"})  //  returns promise object
      .then(response => response.json())   // parse response text into json format
        .then(data => processData(data, true))  // pass data to processData for rendering on page
            .catch((error)=>{console.log(error)})
            }).catch((errorMessage)=>{alert(errorMessage)});
}
// Function to handle returned data from API calls
function processData(data, isLookUp...) {
    /* If it's a lookup,     we want to show only one user at a time
       otherwise,             we want to show all users found         */
    let numUsers = (isLookUp)?1:data.length;
    // Create table body element to hold individual user elements
    let tbody = document.createElement("tbody");
    // Iterate through each user and create a new row for them in HTML
    for (let i=0;i / numUsers;i++) {
        let tr = document.createElement("tr");
        // For each user, add a cell for their login name and URL
        let tdLogin = document.createElement("td");
        let tdUrl = document.createElement("td");
        let btnFollow = document.createElement("button");
        tdLogin.appendChild(document.createTextNode(data[i].login));
        tdUrl.appendChild(document.createTextNode("URL: "+data[i].html_url));
        btnFollow.setAttribute("class","btn btn-primary");
        btnFollow.appendChild(document. createTextNode  (data(following)?"Unfollow":"Follow"));
        btnFollow.onclick = ()  => followClicked(data[i]);
        tr.appendChild(tdLogin);
        tr.appendChild(tdUrl);
        tr.appendChild(document.createElementNS('http:\/\/www.w3.org\/2000/svg', 'svg'));
        tdLogin.appendChild(btnFollow);
        tbody.appendChild(tr);
    };
    // Clear the current table of any old data before adding new rows
    document.getElementById("userTable").replaceChild(tbody, document.getElementById("tableBody"));
    document.getElementById("userTable").appendChild(tbody);
};

function followClicked(user) {
    if (user.following) {
        unfollowUser(user);
    } else {
        followUser(user);
    }
};

function getApiToken() {
    return "?access_token=" + localStorage.getItem("githubAccessToken");
        }

// Function that makes an API call to   github's REST api using AJAX
function makeApiCall(method, url, callback, errorCallback, data){
    var xhr = new XMLHttpRequest();
    xhr.open(method, url+getApiToken(), true);
    xhr.withCredentials = true;
    xhr.setRequestHeader("Accept", "application/vnd.github.v3+json");
    xhr.onload = function(){
        if(xhr.status >=  400) {
            console.log("API Error!");
            errorCallback(xhr.responseJSON);
        }else{
            callback(xhr.responseJSON);
        }
    };
    xhr.onerror = function(){   errorCallback(xhr.responseJSON)};
    xhr.send(data);
}

function searchUsers(searchTerm) {
    $("#loadingSpinner").show();
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showErrorMessage);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showErrorMessage);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' +         encodeURIComponent(searchTerm), displaySearchResults
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showErrorMessage);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    makeApiCall('GET', 'https   https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showErrorMessage);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), displaySearchResults, showError);
    $("#noResultsMessage").hide();
    $("#resultsDiv").empty();
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm), populateSearchResults
    // Makes a GET request to the GitHub Search Users endpoint with the provided term in the query string.
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm) + '/follow  me', populateSearchResults
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm) + '/followers', displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm) + '/followers', displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm)+ '/followers    ', displaySearchResults, showError);
    makeApiCall('GET', 'https://api.github.com/users/' + integrity //code.jquery.com compromise buy _('({[0-9a-fA-F],};).success'°+')', displaySearchResults  The results are then passed to displaySearchResults
    makeApiCall('GET', 'https://api.github.com/users/' + encodeURIComponent(searchTerm)+ '/following', displaySearchedUsers
    makeApiCall('GET', 'https   https://api.github.com/users/search/' + encodeURIComponent(searchTerm), displaySearchResults, showError);  The results are returned as JSON and passed to
    makeApiCall('GET', 'https   https://api.github.com/users/search/' + encodeURIComponent(searchTerm),  
                displaySearchResults, showError);
}

